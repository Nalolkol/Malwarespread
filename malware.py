# -*- coding: utf-8 -*-
"""
Created on Fri Feb  4 11:44:17 2022

@author: Nils_
"""
import numpy as np
import matplotlib.pyplot as plt

S = int(1000000) 
I = int(10)
Re = int(0)
D = int(0)
N = S + I + Re

t = 0

BetaI = 0.8
BetaD = 0.1
BetaRe = 0.2

infected = np.array(I)
dead = np.array(D)
recovered = np.array(Re)
time = np.array(t)

WI = (BetaI*S*I) / N  
WD = (BetaD*S*I) / N
WRe = (BetaRe*S*I) / N
    
R = WI + WRe + WD
    
PI = WI / R
PD = WD / R 
PRe = WRe / R

def HI(I,S):
    I = I + 1
    S = S - 1
    return I, S

def HD(I, D):
    I = I - 1
    D = D + 1
    return I, D

def HRe(I,Re):
    Re = Re + 1
    I = I - 1
    return I, Re

while (t < 10000):
    
    T = np.random.exponential(scale = R)
    t = t + T
    Y = np.random.uniform(low = 0.0, high = R)
    
    if (Y < WI):
        I,S = HI(I, S)
    elif (Y < (WI + WD)):
        I,D = HD(I, D)
    elif (Y < (WI + WD + WRe)):
        I,Re = HRe(I, Re)
        
    N = S + I + Re
    WI = (BetaI*S*I) / N
    WD = (BetaD*S*I) / N
    WRe = (BetaRe*S*I) / N
    R = WI + WD + WRe
    
    infected = np.append(infected, I)
    dead = np.append(dead, D)
    recovered = np.append(recovered, Re)
    time = np.append(time, t)

plt.plot(time, infected)
